<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.8">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>RAG Chat with Multiple LLMs :: AWS System Manager</title>

    
    <link href="/css/nucleus.css?1753531426" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1753531426" rel="stylesheet">
    <link href="/css/hybrid.css?1753531426" rel="stylesheet">
    <link href="/css/featherlight.min.css?1753531426" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1753531426" rel="stylesheet">
    <link href="/css/auto-complete.css?1753531426" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1753531426" rel="stylesheet">
    <link href="/css/theme.css?1753531426" rel="stylesheet">
    <link href="/css/hugo-theme.css?1753531426" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1753531426" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1753531426"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/7-rag/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1753531426"></script>
<script type="text/javascript" src="/js/auto-complete.js?1753531426"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/localhost:1313\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1753531426"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-introduce/" title="Introduction" class="dd-item 
        
        
        
        ">
      <a href="/1-introduce/">
           <b> 1. </b> Introduction
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-prerequiste/" title="Preparation " class="dd-item 
        
        
        
        ">
      <a href="/2-prerequiste/">
           <b> 2. </b> Preparation 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-prerequiste/2.1-launchastack/" title="Launch a CloudFormation stack" class="dd-item 
        
        
        
        ">
      <a href="/2-prerequiste/2.1-launchastack/">
           <b> 2.1 </b> Launch a CloudFormation stack
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-prerequiste/2.2-launchvscode/" title="Launch VSCode on AWS, and Set Up the Environment" class="dd-item 
        
        
        
        ">
      <a href="/2-prerequiste/2.2-launchvscode/">
           <b> 2.2 </b> Launch VSCode on AWS, and Set Up the Environment
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-accessibilitytoinstances/" title="Deploy Amazon Bedrock Serverless Application" class="dd-item 
        
        
        
        ">
      <a href="/3-accessibilitytoinstances/">
           <b> 3. </b> Deploy Amazon Bedrock Serverless Application
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-walkthroughbedrock/" title="Walkthrough Amazon Bedrock Console" class="dd-item 
        
        
        
        ">
      <a href="/4-walkthroughbedrock/">
           <b> 4. </b> Walkthrough Amazon Bedrock Console
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/5-multiplellms/" title="General Chat with Multiple LLMs" class="dd-item 
        
        
        
        ">
      <a href="/5-multiplellms/">
           <b> 5. </b> General Chat with Multiple LLMs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/6-usingamazonkendra/" title="Index the Source Data by Using Amazon Kendra" class="dd-item 
        
        
        
        ">
      <a href="/6-usingamazonkendra/">
           <b> 6. </b> Index the Source Data by Using Amazon Kendra
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/7-rag/" title="RAG Chat with Multiple LLMs" class="dd-item 
        
        active
        
        ">
      <a href="/7-rag/">
           <b> 7. </b> RAG Chat with Multiple LLMs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/8-promptengineering/" title="Prompt Engineering" class="dd-item 
        
        
        
        ">
      <a href="/8-promptengineering/">
           <b> 8. </b> Prompt Engineering
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/9-knowledgebases/" title="Rag Chat with Bedrock Knowledge Bases" class="dd-item 
        
        
        
        ">
      <a href="/9-knowledgebases/">
           <b> 9. </b> Rag Chat with Bedrock Knowledge Bases
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/9-knowledgebases/9.1-createknowledgebase/" title="Create and Test Knowledge Base" class="dd-item 
        
        
        
        ">
      <a href="/9-knowledgebases/9.1-createknowledgebase/">
           <b> 9.1 </b> Create and Test Knowledge Base
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/9-knowledgebases/9.2-integrateknowledgebase/" title="Integrate Knowledge Base with a Lambda Function" class="dd-item 
        
        
        
        ">
      <a href="/9-knowledgebases/9.2-integrateknowledgebase/">
           <b> 9.2 </b> Integrate Knowledge Base with a Lambda Function
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/10-cleanup/" title="Clean up resources" class="dd-item 
        
        
        
        ">
      <a href="/10-cleanup/">
           <b> 10. </b> Clean up resources
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="//localhost:1313/7-rag/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="//localhost:1313/vi/7-rag/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>30-01-2022</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i> <a href="https://www.linkedin.com/in/sutrinh/"  style="color:orange">Sử Trịnh  </a> <br>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
                <a href="https://www.linkedin.com/in/hiepnguyendt"  style="color:orange">Thanh Hiệp </a>
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'>Create a Serverless Chatbot Using Amazon Bedrock, Amazon Kendra, and Your Own Data</a> > RAG Chat with Multiple LLMs
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#rag-based-solution-with-amazon-bedrock-and-langchain">RAG-based solution with Amazon Bedrock and LangChain</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              RAG Chat with Multiple LLMs
            </h1>
          

        



	<p>You have successfully deployed the Amazon Bedrock serverless chatbot application and enabled model access to the required Large Language Models (LLMs) using the Amazon Bedrock console. Additionally, you have completed the setup of Amazon Kendra.</p>
<h2 id="rag-based-solution-with-amazon-bedrock-and-langchain">RAG-based solution with Amazon Bedrock and LangChain</h2>
<p>The solution in this workshop is constructed using the Retrieval-Augmented Generation (RAG) approach. RAG is a model architecture that integrates aspects of both retrieval and generation techniques to enhance the quality and relevance of generated text. When you input a question into the question text box, the following backend steps are run to provide you with an answer derived from the document source:</p>
<p><strong>Retrieval</strong>: This process searches through a large corpus of text data to find relevant information or context. During this stage, Amazon Kendra takes the question from the request and searches for the relevant answers and references.</p>
<p><strong>Augmentation</strong>: After retrieving relevant information, the model uses the retrieved context to augment the generation of text. This means that the generated text is influenced by the retrieved information, ensuring that the generated content is contextually appropriate and informative.</p>
<p><strong>Generation</strong>: Generation in RAG refers to the traditional generative aspect of the model, where it creates new text based on the retrieved and augmented context. This generated text can be in the form of answers, responses, or explanations.</p>
<p><strong>LangChain</strong>: To orchestrate this flow, we employ the LangChain agent in this workshop. LangChain&rsquo;s flexible abstractions and comprehensive toolkit empower developers to harness the capabilities of foundation models (FMs).</p>
<p>In this task, you will deploy a RAG (Retrieve, Analyze, Generate) Lambda function to provide a contextual chatbot experience with your data sets. The sample data sets are stored in Amazon S3 and indexed using Amazon Kendra. To orchestrate the flow across user queries, Kendra index, and LLMs, you will be using LangChain as the orchestration tool. The provided Lambda code utilizes the LangChain API to abstract the complex logic required for this integration.</p>
<p>By leveraging the power of Amazon Bedrock, Amazon Kendra, and LangChain, you can create a seamless and contextual chatbot experience for your users, allowing them to engage with your data sets in a natural and efficient manner.</p>
<p>In this section, you will update and deploy a RAG Lambda function, this function enables with a contextual chat with multiple large language models.</p>
<ol>
<li>
<p>Open the <strong>VSCode</strong> editor.</p>
</li>
<li>
<p>From <strong>bedrock-serverless-workshop</strong> project, open <strong>/lambdas/ragFunctions/ragfunction.py</strong> function, copy the below code and update the function code. This function carries the logic to support Claud3 (Haiku, Sonnet etc.), Mistral and Llama models.
<img src="https://github.com/PVinhP/PPV_Workshop_01/blob/main/Workshop/static/images/5.fwd/task5/007.png?raw=true" alt="ConnectPrivate"></p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>import os
</span></span><span style="display:flex;"><span>import json
</span></span><span style="display:flex;"><span>import boto3
</span></span><span style="display:flex;"><span>from langchain_community.retrievers import AmazonKendraRetriever
</span></span><span style="display:flex;"><span>from langchain_aws import ChatBedrock
</span></span><span style="display:flex;"><span>from langchain.chains import ConversationalRetrievalChain
</span></span><span style="display:flex;"><span>from langchain.memory import ConversationBufferMemory
</span></span><span style="display:flex;"><span>from langchain.prompts import PromptTemplate
</span></span><span style="display:flex;"><span>from langchain.chains import RetrievalQA
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import traceback
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kendra <span style="color:#f92672">=</span> boto3.client<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;kendra&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>chain_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;stuff&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>KENDRA_INDEX_ID <span style="color:#f92672">=</span> os.getenv<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;KENDRA_INDEX_ID&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>S3_BUCKET_NAME <span style="color:#f92672">=</span> os.environ<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;S3_BUCKET_NAME&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>refine_prompt_template <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Below is an instruction that describes a task. &#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Write a response that appropriately completes the request.\n\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;### Instruction:\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;This is the original question: {question}\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;The existing answer: {existing_answer}\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Now there are some additional texts, (if needed) you can use them to improve your existing answer.&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;\n\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;{context_str}\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;\\nn&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Please use the new passage to further improve your answer.\n\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;### Response: &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>initial_qa_template <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Below is an instruction that describes a task. &#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Write a response that appropriately completes the request.\n\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;### Instruction:\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;The following is background knowledge：\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;{context_str}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Please answer this question based on the background knowledge provided above：{question}。\n\n&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;### Response: &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>def lambda_handler<span style="color:#f92672">(</span>event, context<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;Event is: {event}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    event_body <span style="color:#f92672">=</span> json.loads<span style="color:#f92672">(</span>event<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;body&#34;</span><span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>    question <span style="color:#f92672">=</span> event_body<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;query&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;Query is: {question}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    model_id <span style="color:#f92672">=</span> event_body<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;model_id&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    temperature <span style="color:#f92672">=</span> event_body<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;temperature&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    max_tokens <span style="color:#f92672">=</span> event_body<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;max_tokens&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    response <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    status_code <span style="color:#f92672">=</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    PROMPT_TEMPLATE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prompt-engineering/claude-prompt-template.txt&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    try:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> model_id <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;mistral.mistral-7b-instruct-v0:2&#39;</span>:
</span></span><span style="display:flex;"><span>            llm <span style="color:#f92672">=</span> get_mistral_llm<span style="color:#f92672">(</span>model_id,temperature,max_tokens<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            PROMPT_TEMPLATE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prompt-engineering/mistral-prompt-template.txt&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> model_id <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;meta.llama3-1-8b-instruct-v1:0&#39;</span>:
</span></span><span style="display:flex;"><span>            llm <span style="color:#f92672">=</span> get_llama_llm<span style="color:#f92672">(</span>model_id,temperature,max_tokens<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            PROMPT_TEMPLATE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prompt-engineering/llama-prompt-template.txt&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            llm <span style="color:#f92672">=</span> get_claude_llm<span style="color:#f92672">(</span>model_id,temperature,max_tokens<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            PROMPT_TEMPLATE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;prompt-engineering/claude-prompt-template.txt&#39;</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Read the prompt template from S3 bucket</span>
</span></span><span style="display:flex;"><span>        s3 <span style="color:#f92672">=</span> boto3.resource<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;s3&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        obj <span style="color:#f92672">=</span> s3.Object<span style="color:#f92672">(</span>S3_BUCKET_NAME, PROMPT_TEMPLATE<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>        prompt_template <span style="color:#f92672">=</span> obj.get<span style="color:#f92672">()[</span><span style="color:#e6db74">&#39;Body&#39;</span><span style="color:#f92672">]</span>.read<span style="color:#f92672">()</span>.decode<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;utf-8&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;prompt template: {prompt_template}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        retriever <span style="color:#f92672">=</span> AmazonKendraRetriever<span style="color:#f92672">(</span>kendra_client<span style="color:#f92672">=</span>kendra,index_id<span style="color:#f92672">=</span>KENDRA_INDEX_ID<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> chain_type <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;stuff&#34;</span>:
</span></span><span style="display:flex;"><span>            PROMPT <span style="color:#f92672">=</span> PromptTemplate<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                template<span style="color:#f92672">=</span>prompt_template, input_variables<span style="color:#f92672">=[</span><span style="color:#e6db74">&#34;context&#34;</span>, <span style="color:#e6db74">&#34;question&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            chain_type_kwargs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;prompt&#34;</span>: PROMPT<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            qa <span style="color:#f92672">=</span> RetrievalQA.from_chain_type<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                llm<span style="color:#f92672">=</span>llm,
</span></span><span style="display:flex;"><span>                chain_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stuff&#34;</span>,
</span></span><span style="display:flex;"><span>                retriever<span style="color:#f92672">=</span>retriever,
</span></span><span style="display:flex;"><span>                return_source_documents<span style="color:#f92672">=</span>True,
</span></span><span style="display:flex;"><span>                chain_type_kwargs<span style="color:#f92672">=</span>chain_type_kwargs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">=</span> qa<span style="color:#f92672">(</span>question, return_only_outputs<span style="color:#f92672">=</span>False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> chain_type <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;refine&#34;</span>:
</span></span><span style="display:flex;"><span>            refine_prompt <span style="color:#f92672">=</span> PromptTemplate<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                input_variables<span style="color:#f92672">=[</span><span style="color:#e6db74">&#34;question&#34;</span>, <span style="color:#e6db74">&#34;existing_answer&#34;</span>, <span style="color:#e6db74">&#34;context_str&#34;</span><span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>                template<span style="color:#f92672">=</span>refine_prompt_template,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            initial_qa_prompt <span style="color:#f92672">=</span> PromptTemplate<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                input_variables<span style="color:#f92672">=[</span><span style="color:#e6db74">&#34;context_str&#34;</span>, <span style="color:#e6db74">&#34;question&#34;</span><span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>                template<span style="color:#f92672">=</span>prompt_template,
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            chain_type_kwargs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;question_prompt&#34;</span>: initial_qa_prompt, <span style="color:#e6db74">&#34;refine_prompt&#34;</span>: refine_prompt<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            qa <span style="color:#f92672">=</span> RetrievalQA.from_chain_type<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                llm<span style="color:#f92672">=</span>llm, 
</span></span><span style="display:flex;"><span>                chain_type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;refine&#34;</span>,
</span></span><span style="display:flex;"><span>                retriever<span style="color:#f92672">=</span>retriever,
</span></span><span style="display:flex;"><span>                return_source_documents<span style="color:#f92672">=</span>True,
</span></span><span style="display:flex;"><span>                chain_type_kwargs<span style="color:#f92672">=</span>chain_type_kwargs<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">=</span> qa<span style="color:#f92672">(</span>question, return_only_outputs<span style="color:#f92672">=</span>False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        print<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;Response&#39;</span>, response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        source_documents <span style="color:#f92672">=</span> response.get<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;source_documents&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        source_docs <span style="color:#f92672">=</span> <span style="color:#f92672">[]</span>
</span></span><span style="display:flex;"><span>        previous_source <span style="color:#f92672">=</span> None
</span></span><span style="display:flex;"><span>        previous_score <span style="color:#f92672">=</span> None
</span></span><span style="display:flex;"><span>        response_data <span style="color:#f92672">=</span> <span style="color:#f92672">[]</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#if chain_type == &#34;stuff&#34;:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> source_doc in source_documents:
</span></span><span style="display:flex;"><span>            source <span style="color:#f92672">=</span> source_doc.metadata<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;source&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>            score <span style="color:#f92672">=</span> source_doc.metadata<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;score&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> source !<span style="color:#f92672">=</span> previous_source or score !<span style="color:#f92672">=</span> previous_score:
</span></span><span style="display:flex;"><span>                source_data <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;source&#34;</span>: source,
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;score&#34;</span>: score
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>                response_data.append<span style="color:#f92672">(</span>source_data<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                previous_source <span style="color:#f92672">=</span> source
</span></span><span style="display:flex;"><span>                previous_score <span style="color:#f92672">=</span> score
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        response_with_metadata <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;answer&#34;</span>: response.get<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;result&#39;</span><span style="color:#f92672">)</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;source_documents&#34;</span>: response_data
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;statusCode&#39;</span>: status_code,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;headers&#39;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Origin&#39;</span>: <span style="color:#e6db74">&#39;*&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Headers&#39;</span>: <span style="color:#e6db74">&#39;Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Methods&#39;</span>: <span style="color:#e6db74">&#39;OPTIONS,POST&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;body&#39;</span>: json.dumps<span style="color:#f92672">(</span>response_with_metadata<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    except Exception as e:
</span></span><span style="display:flex;"><span>        print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;An unexpected error occurred: {str(e)}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        stack_trace <span style="color:#f92672">=</span> traceback.format_exc<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>        print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;stack trace: {stack_trace}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        print<span style="color:#f92672">(</span>f<span style="color:#e6db74">&#34;error: {str(e)}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> str<span style="color:#f92672">(</span>e<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;statusCode&#39;</span>: status_code,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;headers&#39;</span>: <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Origin&#39;</span>: <span style="color:#e6db74">&#39;*&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Headers&#39;</span>: <span style="color:#e6db74">&#39;Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;Access-Control-Allow-Methods&#39;</span>: <span style="color:#e6db74">&#39;OPTIONS,POST&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;body&#39;</span>: json.dumps<span style="color:#f92672">({</span><span style="color:#e6db74">&#39;error&#39;</span>: response<span style="color:#f92672">})</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>def get_claude_llm<span style="color:#f92672">(</span>model_id, temperature, max_tokens<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    model_kwargs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;max_tokens&#34;</span>: max_tokens,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;temperature&#34;</span>: temperature, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_k&#34;</span>: 50, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_p&#34;</span>: 0.95
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    llm <span style="color:#f92672">=</span> ChatBedrock<span style="color:#f92672">(</span>model_id<span style="color:#f92672">=</span>model_id, model_kwargs<span style="color:#f92672">=</span>model_kwargs<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> llm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>def get_llama_llm<span style="color:#f92672">(</span>model_id, temperature, max_tokens<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    model_kwargs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;max_gen_len&#34;</span>: max_tokens,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;temperature&#34;</span>: temperature, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_p&#34;</span>: 0.9
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    llm <span style="color:#f92672">=</span> ChatBedrock<span style="color:#f92672">(</span>model_id<span style="color:#f92672">=</span>model_id, model_kwargs<span style="color:#f92672">=</span>model_kwargs<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> llm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>def get_mistral_llm<span style="color:#f92672">(</span>model_id, temperature, max_tokens<span style="color:#f92672">)</span>:
</span></span><span style="display:flex;"><span>    model_kwargs <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;max_tokens&#34;</span>: max_tokens,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;temperature&#34;</span>: temperature, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_k&#34;</span>: 50, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;top_p&#34;</span>: 0.9
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    llm <span style="color:#f92672">=</span> ChatBedrock<span style="color:#f92672">(</span>model_id<span style="color:#f92672">=</span>model_id, model_kwargs<span style="color:#f92672">=</span>model_kwargs<span style="color:#f92672">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> llm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>def get_memory<span style="color:#f92672">()</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    memory <span style="color:#f92672">=</span> ConversationBufferMemory<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>        memory_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;chat_history&#34;</span>,
</span></span><span style="display:flex;"><span>        input_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;question&#34;</span>,
</span></span><span style="display:flex;"><span>        output_key<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;answer&#34;</span>,
</span></span><span style="display:flex;"><span>        return_messages<span style="color:#f92672">=</span>True
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> memory
</span></span></code></pre></div><ol start="3">
<li>From <strong>VSCode</strong> terminal, run the following command to build and deploy with new updated lambda code.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cd ~/environment/bedrock-serverless-workshop
</span></span><span style="display:flex;"><span>sam build <span style="color:#f92672">&amp;&amp;</span> sam deploy
</span></span></code></pre></div><p>In this task, you have the opportunity to work with following LLM models, each offering unique functionalities and specializations. These models include:</p>
<ul>
<li><strong>anthropic.claude-3-haiku - Claude 3 Haiku</strong> is Anthropic’s fastest, most compact model for near-instant responsiveness. Haiku is the best choice for building seamless AI experiences that mimic human interactions.</li>
<li><strong>anthropic.claude-3-5-sonnet - Anthropic’s</strong> most intelligent and advanced model, Claude 3.5 Sonnet, demonstrates exceptional capabilities across a diverse range of tasks and evaluation.</li>
<li><strong>anthropic.claude-3-opus - Opus</strong> is a highly intelligent model with reliable performance on complex tasks. It can navigate open-ended prompts and sight-unseen scenarios with remarkable fluency and human-like understanding. Use Opus to automate tasks, and accelerate research and development across a diverse range of use cases and industries.</li>
<li><strong>mistral.mistral-7b-instruct - Mistral</strong> is a highly efficient large language model optimized for high-volume, low-latency language-based tasks. Popular use cases for Mistral are text summarization, structuration, question answering, and code completion</li>
<li><strong>meta.llama3-1-8b-instruct - Llama 3.1 8B</strong> is best suited for limited computational power and resources. The model excels at text summarization, text classification, sentiment analysis, and language translation requiring low-latency inferencing.</li>
</ul>
<ol start="4">
<li>Return to the browser and open the chatbot webpage. Click on <strong>RAG Chat with LLMs</strong> link. The webpage is displayed as follows:</li>
</ol>
<p><img src="https://github.com/PVinhP/PPV_Workshop_01/blob/main/Workshop/static/images/5.fwd/task5/008.png?raw=true" alt="ConnectPrivate"></p>
<ol start="5">
<li>Ask any question by typing in the Query text box and click Ask Question button. You can try with a sample question from the right side panel. Here is a sample question and the response from Claude 3 Haiku. You can try with other LLMs and compare the results.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>What is federal funds rate as of September 2024?
</span></span></code></pre></div><p><img src="https://github.com/PVinhP/PPV_Workshop_01/blob/main/Workshop/static/images/5.fwd/task5/009.png?raw=true" alt="ConnectPrivate"></p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/6-usingamazonkendra/" title="Index the Source Data by Using Amazon Kendra"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/8-promptengineering/" title="Prompt Engineering" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1753531426"></script>
    <script src="/js/perfect-scrollbar.min.js?1753531426"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1753531426"></script>
    <script src="/js/jquery.sticky.js?1753531426"></script>
    <script src="/js/featherlight.min.js?1753531426"></script>
    <script src="/js/highlight.pack.js?1753531426"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1753531426"></script>
    <script src="/js/learn.js?1753531426"></script>
    <script src="/js/hugo-learn.js?1753531426"></script>

    <link href="/mermaid/mermaid.css?1753531426" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1753531426"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
